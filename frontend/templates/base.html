<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <title>
      {% block page_title %}Knowledge Assistant | AI-Powered Internal Search{%
      endblock %}
    </title>

    <!-- SEO Metadata -->
    <meta
      name="description"
      content="Secure, AI-powered internal knowledge assistant. Index your Google Drive and find answers instantly from your private documents."
    />
    <meta
      name="keywords"
      content="AI assistant, knowledge base, RAG, internal search, Google Drive indexing, semantic search"
    />
    <meta name="author" content="Arjun Gupta" />
    <link rel="canonical" href="{{ request.url }}" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ request.url }}" />
    <meta
      property="og:title"
      content="Knowledge Assistant | AI-Powered Internal Search"
    />
    <meta
      property="og:description"
      content="Secure, AI-powered internal knowledge assistant. Index your Google Drive and find answers instantly from your private documents."
    />
    <meta
      property="og:image"
      content="{{ url_for('static', filename='img/logo.png', _external=True) }}"
    />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="{{ request.url }}" />
    <meta
      property="twitter:title"
      content="Knowledge Assistant | AI-Powered Internal Search"
    />
    <meta
      property="twitter:description"
      content="Secure, AI-powered internal knowledge assistant. Index your Google Drive and find answers instantly from your private documents."
    />
    <meta
      property="twitter:image"
      content="{{ url_for('static', filename='img/logo.png', _external=True) }}"
    />

    <link
      rel="icon"
      type="image/x-icon"
      href="{{ url_for('static', filename='img/favicon.ico') }}"
    />
    <!-- CSS Modules -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/variables.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/base.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/layout.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/components.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/auth.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/chat.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/config.css') }}"
    />
  </head>
  <body>
    {% set is_auth_page = request.path in ["/login", "/signup"] %} {% set
    protected_routes = ['/', '/configure'] %} {% set is_protected = request.path
    in protected_routes %} {% if not is_auth_page %}
    <nav id="main-nav" {% if is_protected %}style="display: none;" {% endif %}>
      <div class="nav-left">
        <a href="/" class="logo-link">
          <img
            src="{{ url_for('static', filename='img/logo.png') }}"
            alt="Knowledge Assistant Logo"
            class="nav-logo"
          />
          <div class="logo">Knowledge Assistant</div>
        </a>
      </div>
      <div class="nav-center nav-links">
        <a href="/" id="chat-link" style="display: none">Chat</a>
        <a href="/configure" id="config-link" style="display: none"
          >Configure</a
        >
      </div>
      <div class="nav-right nav-links">
        <a href="/login" id="login-link">Login</a>
        <div id="user-menu" class="user-menu" style="display: none">
          <button
            id="user-menu-btn"
            type="button"
            aria-haspopup="true"
            aria-expanded="false"
          >
            <span id="user-avatar">U</span>
          </button>
          <div id="user-menu-dropdown" class="user-menu-dropdown">
            <div class="user-menu-name" id="user-name">User</div>
            <div class="user-menu-email" id="user-email">user@example.com</div>
            <button id="logout-link" type="button">Logout</button>
          </div>
        </div>
      </div>
    </nav>
    {% endif %}

    <div id="app-toast" class="app-toast" style="display: none">
      <div class="app-toast-body">
        <div class="app-toast-icon" id="app-toast-icon"></div>
        <div class="app-toast-content">
          <span id="app-toast-message"></span>
        </div>
        <button id="app-toast-ok" type="button">OK</button>
      </div>
    </div>

    <div id="app-confirm-toast" class="app-toast" style="display: none">
      <div class="app-toast-body confirm">
        <div class="app-toast-icon" id="app-confirm-icon">⚠️</div>
        <div class="app-toast-content">
          <span id="app-confirm-message"></span>
        </div>
        <div class="app-toast-buttons">
          <button id="app-confirm-yes" type="button" class="btn-danger">
            Yes, Remove
          </button>
          <button id="app-confirm-dismiss" type="button" class="btn-secondary">
            Dismiss
          </button>
        </div>
      </div>
    </div>

    <div
      id="main-content"
      {%
      if
      is_protected
      %}style="display: none;"
      {%
      endif
      %}
    >
      {% block content %}{% endblock %}
    </div>

    <footer class="app-footer">
      <div class="footer-content">
        <div class="footer-links">
          <a href="/privacy">Privacy Policy</a>
          <a href="/terms">Terms of Service</a>
          <a href="mailto:arjuntheprogrammer@gmail.com">Contact Support</a>
        </div>
        <div class="footer-copyright">
          &copy; 2026 Internal Knowledge Assistant. Powered by Google Cloud
        </div>
      </div>
    </footer>

    <script id="firebase-config" type="application/json">
      {{ firebase_config | tojson }}
    </script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.8/dist/purify.min.js"></script>
    <script src="https://apis.google.com/js/api.js" async defer></script>
    <script
      type="module"
      src="{{ url_for('static', filename='app.js') }}"
    ></script>
  </body>
</html>

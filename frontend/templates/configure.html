{% extends "base.html" %} {% block page_title %}Configure | Knowledge
Assistant{% endblock %} {% block content %}
<div class="container admin-page">
  <div class="admin-grid">
    <div id="config-notice" class="config-notice" style="display: none">
      Please complete configuration before chatting.
    </div>
    <h2>Configuration</h2>
    <div class="admin-left">
      <div class="config-section">
        <h3>OpenAI</h3>
        <div style="margin-bottom: 12px; line-height: 1.6">
          <div style="font-size: 0.85rem; color: var(--text-muted)">
            Using model
            <span
              style="
                color: var(--primary-color);
                font-weight: 800;
                background: rgba(59, 130, 246, 0.08);
                padding: 2px 8px;
                border-radius: 6px;
                border: 1px solid rgba(59, 130, 246, 0.15);
              "
              >gpt-4.1-mini</span
            >
          </div>
          <div
            style="
              font-size: 0.85rem;
              color: var(--text-muted);
              margin-top: 4px;
            "
          >
            Add your OpenAI API key below.
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>API Key</label>
            <input
              type="password"
              id="openai-key"
              placeholder="sk-..."
              autocomplete="off"
            />
          </div>
        </div>
        <div id="openai-key-status" class="form-status">Not configured</div>
        <button
          id="test-openai-btn"
          class="btn-secondary"
          style="margin-top: 10px"
        >
          Test OpenAI Key
        </button>
        <span
          id="openai-test-result"
          style="margin-left: 10px; font-weight: 600"
        ></span>
        <div
          style="font-size: 0.75rem; color: var(--text-muted); margin-top: 6px"
        >
          Settings save automatically when you run a test.
        </div>
      </div>

      <div class="config-section">
        <h3>Google Drive</h3>
        <p
          style="
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 8px;
          "
        >
          Authorize Drive access and provide a single folder ID to index.
        </p>
        <div id="google-auth-section" class="drive-auth-block">
          <div class="drive-auth-row">
            <button id="auth-btn" class="btn-secondary">
              Authorize Google Drive
            </button>
            <span id="drive-auth-status" class="status-inline"
              >Status: Checking...</span
            >
          </div>
          <p id="auth-hint" class="drive-auth-hint">
            Authorize to access your Drive.
          </p>
        </div>

        <!-- Folder Selection -->
        <div class="folder-picker-section" style="margin-top: 16px">
          <label
            style="
              font-size: 0.85rem;
              font-weight: 600;
              color: var(--text-muted);
              display: block;
              margin-bottom: 8px;
            "
          >
            Select Folder to Index
          </label>

          <div
            id="selected-folder-display"
            class="selected-folder-display"
            style="display: none"
          >
            <span class="folder-icon">üìÅ</span>
            <span id="selected-folder-name" class="selected-folder-name"
              >No folder selected</span
            >
            <div class="folder-display-actions">
              <button id="change-folder-btn" type="button" class="btn-link">
                Change
              </button>
              <span class="action-divider">|</span>
              <button
                id="remove-folder-btn"
                type="button"
                class="btn-link btn-link-danger"
              >
                Remove
              </button>
            </div>
          </div>

          <div id="folder-picker-actions" class="folder-picker-actions">
            <button id="select-folder-btn" type="button" class="btn-primary">
              üìÅ Select Folder from Drive
            </button>
          </div>

          <input type="hidden" id="drive-folder-id" value="" />
        </div>

        <div class="drive-auth-row" style="margin-top: 16px">
          <button id="verify-drive-btn" class="btn-primary">
            Scan Google Drive
          </button>
          <span id="drive-test-status" class="status-inline"
            >Not connected yet.</span
          >
        </div>
        <div
          id="drive-test-results"
          class="drive-test-results"
          style="display: none; margin-top: 10px"
        >
          <ul
            id="drive-files-list"
            style="
              margin: 0;
              padding-left: 18px;
              font-size: 0.9rem;
              line-height: 1.6;
            "
          ></ul>
        </div>
        <div
          id="indexing-status-inline"
          class="indexing-status-inline"
          style="display: none; margin-top: 12px"
        >
          <span id="indexing-inline-text" class="indexing-inline-text"></span>
        </div>
      </div>
    </div>

    <div class="admin-right"></div>
  </div>
</div>

<div id="fullscreen-loader" class="fullscreen-loader">
  <div class="spinner"></div>
  <div class="loader-text">Scanning Google Drive...</div>
  <div style="margin-top: 8px; font-size: 0.9rem; color: var(--text-muted)">Please do not close this tab</div>
</div>

{% endblock %}
